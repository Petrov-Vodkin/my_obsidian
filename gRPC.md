2022-02-22 20:24
#tag
# gRPC
```bash
pip install grpc
```

### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Python –∏ gRPC
—Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –æ–±—ä–µ–º–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –î—ç–Ω–∞ –•–∏–ø—à–º–∞–Ω–∞ [Python Microservices With gRPC](https://realpython.com/python-microservices-grpc/).

[–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](https://ru.wikipedia.org/wiki/%D0%9C%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BD%D0%B0%D1%8F_%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0) ‚Äì —Å–ø–æ—Å–æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö —Å–∏—Å—Ç–µ–º: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, –Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º. –ò–∑ —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤—ã —É–∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ä–∞–±–æ—Ç–µ —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ Python —Å –ø–æ–º–æ—â—å—é [gRPC](https://ru.wikipedia.org/wiki/GRPC) ‚Äì –æ–¥–Ω–æ–≥–æ –∏–∑ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –≤ —ç—Ç–æ–π —Å—Ñ–µ—Ä–µ.
-   —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –ø–æ–º–æ—â—å—é Python, gRPC –∏ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤,
-   –ø—Ä–∏–º–µ–Ω–∏—Ç—å —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.  

–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —ç—Ç–æ–≥–æ —Ç—É—Ç–æ—Ä–∏–∞–ª–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ RealPython](https://github.com/realpython/materials/tree/master/python-microservices-with-grpc).

### –ß–µ–º —Ç–∞–∫ —Ö–æ—Ä–æ—à–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%A7%D0%B5%D0%BC-%D1%82%D0%B0%D0%BA-%D1%85%D0%BE%D1%80%D0%BE%D1%88%D0%B0-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BD%D0%B0%D1%8F-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0?)

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ –∫–æ–º–ø–∞–Ω–∏–∏, —Å–æ–∑–¥–∞—é—â–µ–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Å–∞–π—Ç, –ø—Ä–æ–¥–∞—é—â–∏–π –∫–Ω–∏–≥–∏. –í –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–∞–∂–¥—ã–π –ø–∏—à–µ—Ç –∫–æ–¥ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω–æ–π –ø–æ–∫—É–ø–æ–∫, —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –∑–∞–¥–∞—á –ª–æ–≥–∏—Å—Ç–∏–∫–∏.

–•–æ—Ç–∏–º –ª–∏ –º—ã, —á—Ç–æ–±—ã –≤–µ—Å—å –∫–æ–¥ –±—ã–ª –≤ –æ–¥–Ω–æ–º –≥–∏–≥–∞–Ω—Ç—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏? –ö–æ–Ω–µ—á–Ω–æ, –Ω–µ—Ç ‚Äì –º—ã –±—ã –ø—Ä–µ–¥–ø–æ—á–ª–∏, —á—Ç–æ–±—ã –∫–æ–¥, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º –ø—Ä–æ–¥—É–∫—Ç–∞, —Ç–æ–∂–µ –±—ã–ª –º–æ–¥—É–ª—å–Ω—ã–º: –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `cart` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω–æ–π, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `inventory` –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Å–∫–ª–∞–¥—Å–∫–æ–≥–æ —É—á–µ—Ç–∞.

#### –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C)

–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –æ–±—ã—á–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø—É—Ç–∏ –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è. –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä —Ö–æ—á–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é ¬´–ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –±–æ–ª–µ–µ –¥–≤—É—Ö –∫–Ω–∏–≥ –æ–¥–Ω–∞ –∫–Ω–∏–≥–∞ –≤ –ø–æ–¥–∞—Ä–æ–∫¬ª. –í—ã ‚Äì —á–ª–µ–Ω –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ø—Ä–æ—Å–∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é. –ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –≤–µ—Å—å –∫–æ–¥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

–í—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–¥ –≤ –ª–æ–≥–∏–∫—É –∫–æ—Ä–∑–∏–Ω—ã, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –≤ –Ω–µ–π –±–æ–ª–µ–µ –¥–≤—É—Ö –∫–Ω–∏–≥. –î–∞–ª–µ–µ –≤—ã—á–∏—Ç–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–∞–º–æ–π –¥–µ—à–µ–≤–æ–π –∫–Ω–∏–≥–∏ –∏–∑ –æ–±—â–µ–π —Å—É–º–º—ã –∫–æ—Ä–∑–∏–Ω—ã. –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º ‚Äì –¥–µ–ª–∞–µ–º [pull request](https://proglib.io/p/painful-git).

–ó–∞—Ç–µ–º –ø—Ä–æ–¥–∞–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–º–µ—á–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ —Ç–∞–∫–∂–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ –∫–Ω–∏–≥. –≠—Ç–æ —Ç–æ–∂–µ –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ. –ü–æ—Å–∫–æ–ª—å–∫—É –ª–æ–≥–∏–∫–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—é, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ–¥–µ –∫–æ—Ä–∑–∏–Ω—ã, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ –ø–æ—Ç–æ–∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞. –ë—É–¥–µ–º –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–æ–ª–±–µ—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, —É–∫–∞–∑–∞–≤, —á—Ç–æ –ø—Ä–æ–¥–∞–∂–∞ –±—ã–ª–∞ —á–∞—Å—Ç—å—é —Ä–µ–∫–ª–∞–º–Ω–æ–π –∞–∫—Ü–∏–∏: `buy_two_get_one_free_promo`. –í—ã–ø–æ–ª–Ω–µ–Ω–æ.

–ó–∞—Ç–µ–º –Ω–∞–º –Ω–∞–ø–æ–º–∏–Ω–∞—é—Ç, —á—Ç–æ –∞–∫—Ü–∏—è –¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑. –¢–æ –µ—Å—Ç—å –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é –ª–æ–≥–∏–∫—É, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –±—ã–ª –ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ `buy_two_get_one_free_promo` –¥–ª—è –∫–∞–∫–∏—Ö-–ª–∏–±–æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ —Å–∫—Ä—ã—Ç—å –∏ —Ä–µ–∫–ª–∞–º–Ω—ã–π –±–∞–Ω–Ω–µ—Ä –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –ø–æ—ç—Ç–æ–º—É –º—ã —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º —ç—Ç—É –ø—Ä–æ–≤–µ—Ä–∫—É. –¢–∞–∫, –∞ –µ—â—ë –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞ —Ç–µ–º, –∫—Ç–æ –µ—â–µ –Ω–µ –ø–æ—É—á–∞—Å—Ç–≤–æ–≤–∞–ª –≤ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏... –î–æ–±–∞–≤–∏–º –∏ —ç—Ç–æ.

–°–ø—É—Å—Ç—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π, –∏ –µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–æ–≤–æ–π –æ–±—â–µ–π [–±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö](https://proglib.io/p/sql-digest). –í—Å–µ —ç—Ç–∏ —Å—Å—ã–ª–∫–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å. –ù–æ –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Ç–µ–∫—É—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –ø–æ –≤—Å–µ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ.

–†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤—Å–µ–≥–æ –∫–æ–¥–∞ –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω—ã–º. –ò–Ω–æ–≥–¥–∞ —Ö–æ—Ä–æ—à–æ —Ä–∞—Å—á–µ—Ä—Ç–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –î—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞ –º–æ–≥—É—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–∏—Å–æ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π API, —Å–∫—Ä—ã–≤–∞—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

#### –ì–∏–±–∫–æ—Å—Ç—å[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%93%D0%B8%D0%B1%D0%BA%D0%BE%D1%81%D1%82%D1%8C)
–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –¥–∞–µ—Ç –±–æ–ª—å—à—É—é –≥–∏–±–∫–æ—Å—Ç—å. `–ú–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö`. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Ä–µ–¥–∫–æ –ø–µ—Ä–≤–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–∏—à–µ—Ç—Å—è –Ω–∞ Ruby –∏–ª–∏ PHP. –ù–æ —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Ç–æ–∂–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —ç—Ç–∏—Ö —è–∑—ã–∫–∞—Ö!

–ö–∞–∂–¥—ã–π `–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å`. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–≤–æ–¥–æ–º-–≤—ã–≤–æ–¥–æ–º, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏, –∑–∞–≥—Ä—É–∑–∫–æ–π —à–∞–±–ª–æ–Ω–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ —Å –¥–∏—Å–∫–∞. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω–∞—á–µ ‚Äì –æ–±—ã—á–Ω–æ –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ [–º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è](https://proglib.io/tag/Data%20science) –∏ –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –ü–æ—ç—Ç–æ–º—É –¥–∞–∂–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ç–∏ `–¥–≤–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ Python –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏`.

–ï—Å–ª–∏ –≤–µ—Å—å –≤–∞—à –∫–æ–¥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å –µ–≥–æ –ø—Ä–∏–¥–µ—Ç—Å—è —Ç–æ–∂–µ —Ü–µ–ª–∏–∫–æ–º. –≠—Ç–æ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ ‚Äì –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–π –Ω–µ–±–æ–ª—å—à–æ–π —á–∞—Å—Ç–∏ –∫–æ–¥–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤—ã—Ö–æ–¥—É –∏–∑ —Å—Ç—Ä–æ—è –≤—Å–µ–≥–æ —Å–∞–π—Ç–∞.(`—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤`)

#### –†–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%A0%D0%B0%D0%B7%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8)

–ö–æ–≥–¥–∞ –æ–¥–Ω–∞ –∫–æ–¥–æ–≤–∞—è –±–∞–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ª—é–¥–µ–π, —á–∞—Å—Ç–æ –Ω–µ—Ç —á–µ—Ç–∫–æ–≥–æ –≤–∏–¥–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∫–æ–¥–∞.

–û–¥–Ω–∏–º –∏–∑ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ `–∫–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç —á–µ—Ç–∫–æ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å —Å–≤–æ–π –∫–æ–¥`. –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –≤ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–µ—Ç–∫–æ–µ –≤–∏–¥–µ–Ω–∏–µ —Å–≤–æ–µ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∫–æ–¥ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —á–∏—Å—Ç—ã–º –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–º. –≠—Ç–æ —Ç–∞–∫–∂–µ –¥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –∫—Ç–æ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤ –∫–æ–¥ –∏–ª–∏ –≤–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫.

### –ü–æ—á–µ–º—É –∂–µ ¬´–º–∏–∫—Ä–æ¬ª? –ù–∞—Å–∫–æ–ª—å–∫–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞–ª –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å?

–ù–∞—Å–∫–æ–ª—å–∫–æ –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã ‚Äì –æ–¥–Ω–∞ –∏–∑ —Ç–µ—Ö —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –∂–∞—Ä–∫–∏–µ —Å–ø–æ—Ä—ã —Å—Ä–µ–¥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤. –í—Å—Ç–∞–≤–∏–º —Å–≤–æ–∏ –ø–∞—Ä—É –∫–æ–ø–µ–µ–∫: –º–∏–∫—Ä–æ ‚Äì –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø—Ä–∏—Å—Ç–∞–≤–∫–∞. –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä–æ—Å—Ç–æ –æ —Å–µ—Ä–≤–∏—Å–∞—Ö.

–°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º. –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, —ç—Ç–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —Ü–µ–ª–∏ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞. –ü—Ä–∏–≤–µ–¥–µ–º –∞–Ω–∞–ª–æ–≥–∏—é. –§–∞–π–ª–æ–≤—ã–π –æ–±—ä–µ–∫—Ç Python –∏–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç–æ–¥—ã. –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.read()` –∏ `.write()`, –∏–ª–∏, –µ—Å–ª–∏ —Ö–æ—Ç–∏–º, `.readlines()`. –ù–∞–º –Ω–µ –Ω—É–∂–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏–ª–∏ –∫–ª–∞—Å—Å—ã `FileReader` –∏ `FileWriter`. –í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å —è–∑—ã–∫–∞–º–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ç–∞–∫ –¥–µ–ª–∞–µ—Ç—Å—è, –∏, –º–æ–∂–µ—Ç –±—ã—Ç—å, –≤–∞–º —É–∂–µ –∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ —ç—Ç–æ –Ω–µ–º–Ω–æ–≥–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ –∏ –∑–∞–ø—É—Ç–∞–Ω–Ω–æ. –° –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –¥–µ–ª–∞ –æ–±—Å—Ç–æ—è—Ç —Ç–∞–∫ –∂–µ.

`–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Ç—Ä—É–¥–Ω–µ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, —á–µ–º –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–¥`. –ï—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ö–æ—á–µ—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, –µ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —ç—Ç–æ –≤ —Å–≤–æ–µ–π —Å—Ä–µ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –° –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –≤—Å–µ –Ω–µ —Ç–∞–∫ –ø–ª–æ—Ö–æ, –Ω–æ –µ—Å–ª–∏ –∏—Ö –¥–µ—Å—è—Ç–∫–∏, —ç—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Ç—Ä—É–¥–Ω–æ–π –∑–∞–¥–∞—á–µ–π.

__`–ü—Ä–∏–º–µ—Ä`__ —Ç–æ–≥–æ, –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–Ω–∏–∂–Ω—ã–π –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã:
-   `Marketplace` –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Å–∞–π—Ç—É.
-   `Cart` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª–æ–∂–∏–ª –≤ —Å–≤–æ—é –∫–æ—Ä–∑–∏–Ω—É –∏ –ø—Ä–æ—Ü–µ—Å—Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.
-   `Transactions` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–ª–∞—Ç–µ–∂–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏.
-   `Inventory` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–º, –∫–∞–∫–∏–µ –∫–Ω–∏–≥–∏ –µ—Å—Ç—å –≤ –Ω–∞–ª–∏—á–∏–∏.
-   `User Account` —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–∞–Ω–Ω—ã–º–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –ø–∞—Ä–æ–ª–µ–π.
-   `Reviews` —Ö—Ä–∞–Ω–∏—Ç –æ—Ü–µ–Ω–∫–∏ –∫–Ω–∏–≥ –∏ –æ—Ç–∑—ã–≤—ã, –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

–≠—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –∞ –Ω–µ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫. –û–¥–Ω–∞–∫–æ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, —á—Ç–æ –ª–æ–≥–∏–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Reviews` –±—ã–ª —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç —Å –æ—à–∏–±–∫–æ–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–π—Ç –∏ —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø–æ–∫—É–ø–∫–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –æ—Ç–∑—ã–≤—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è.

#### –ö–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∏ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏
–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã [–Ω–µ –≤—Å–µ–≥–¥–∞ –ª—É—á—à–µ –º–æ–Ω–æ–ª–∏—Ç–æ–≤](https://proglib.io/p/monolitnaya-vs-mikroservisnaya-arhitektura-2019-09-16), –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Å—å –∫–æ–¥ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, (–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –Ω–∞—á–∞–ª–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è) –º–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ. –û–Ω–∞ —É–ø—Ä–æ—â–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π —Å–ª—É–∂–±—ã –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

–ö–æ–º–ø—Ä–æ–º–∏—Å—Å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã –≤—Å–µ —ç—Ç–∏ –≤–µ—â–∏ –º–æ–≥—É—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞—Ç—Ä—É–¥–Ω—è—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –∑–∞–º–µ–¥–ª—è—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –¥–µ–ª–∞—Ç—å –µ–≥–æ –±–æ–ª–µ–µ —Ö—Ä—É–ø–∫–∏–º. –¢–æ –µ—Å—Ç—å `–º–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ —É—Å–∏–ª–∏—è –Ω–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ`, –Ω–æ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –º–æ–∂–µ—Ç –∑–∞—Å—Ç–æ–ø–æ—Ä–∏—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ. `–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å –≤–∞–º –≤—Ä–µ–º–µ–Ω–∏ –∏ —É—Å–∏–ª–∏–π` –≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ, –Ω–æ –µ—Å–ª–∏ –≤—Å–µ —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤ `–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ –ª—É—á—à–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è`.

### –ü—Ä–∏–º–µ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ù–∞—á–Ω–µ–º —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –Ω–∞—à–∏–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–º–µ—Ä–æ–º. –®–∞–≥ –∑–∞ —à–∞–≥–æ–º –º—ã —Å–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–æ–±–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ –∏ API –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:

-   `Marketplace` ‚Äì –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–µ–µ –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥, –ø—Ä–æ–¥–∞–≤–∞–µ–º—ã—Ö –Ω–∞ —Å–∞–π—Ç–µ.
-   `Recommendations` ‚Äì –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

![–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º](https://media.proglib.io/posts/2021/02/12/0872a00f66a2469095e67c6c22cc2f9f.png)

–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º `Marketplace` —á–µ—Ä–µ–∑ —Å–≤–æ–π –±—Ä–∞—É–∑–µ—Ä, –∞ —É–∂–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Marketplace` –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º `Recommendations`.

–ó–∞–¥—É–º–∞–µ–º—Å—è –Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–∏–µ –æ–± API —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –ú—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏–º–µ–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π:

-   `User ID`: –º—ã —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
-   `Book category`: —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å API –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º, –º—ã –¥–æ–±–∞–≤–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–Ω–∏–≥.
-   `Max results`: –º—ã –Ω–µ —Ö–æ—Ç–∏–º –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –∫–Ω–∏–≥–∏, –∏–º–µ—é—â–∏–µ—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏, –ø–æ—ç—Ç–æ–º—É –¥–æ–±–∞–≤–∏–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∑–∞–ø—Ä–æ—Å.

–î–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏ –±—É–¥—É—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

-   `Book ID`: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —á–∏—Å–ª–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–Ω–∏–≥–∏.
-   `Book title`: –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å API –±–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, —Å –ø–æ–º–æ—â—å—é —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ [Protocol Buffers](https://ru.wikipedia.org/wiki/Protocol_Buffers) (Protobuf):

```protobuf
syntax = "proto3";

enum BookCategory {
    MYSTERY = 0;
    SCIENCE_FICTION = 1;
    SELF_HELP = 2;
}
message RecommendationRequest {
    int32 user_id = 1;
    BookCategory category = 2;
    int32 max_results = 3;
}
message BookRecommendation {
    int32 id = 1;
    string title = 2;
}
message RecommendationResponse {
    repeated BookRecommendation recommendations = 1;
}
service Recommendations {
    rpc Recommend (RecommendationRequest) returns (RecommendationResponse);
}
    
```

–ü—Ä–æ—Ç–æ–∫–æ–ª Protobuf —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ Google –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å API. –ü–æ–∫–∞ –≤ –æ–±—â–∏—Ö —á–µ—Ä—Ç–∞—Ö –ø–æ—è—Å–Ω–∏–º, —á—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

-   –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `proto3`.
-   –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–Ω–∏–≥ (`MYSTERY`, `SCIENCE_FICTION`, `SELF_HELP`), –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —á–∏—Å–ª–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä.
-   –û–ø—Ä–µ–¥–µ–ª—è–µ–º API-–∑–∞–ø—Ä–æ—Å—ã. –ò—Å–ø–æ–ª—å–∑—É–µ–º 32-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ (`int32`) –¥–ª—è –ø–æ–ª–µ–π `user_ID` –∏ `max_results`. –£–∫–∞–∑—ã–≤–∞–µ–º —Ç–∞–∫–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—ã—à–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ `BookCategory`. –ö—Ä–æ–º–µ –∏–º–µ–Ω–∏ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—é –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —á–∏—Å–ª–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—è.
-   –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–∏–ø `BookRecommendation` –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–Ω–∏–≥–∏. –û–Ω –∏–º–µ–µ—Ç 32-–±–∏—Ç–Ω—ã–π —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.
-   –û–ø–∏—Å—ã–≤–∞–µ–º –æ—Ç–∫–ª–∏–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ `Recommendations`.
-   –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç API-–º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `RecommendationRequest` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `RecommendationResponse`. –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `rpc` –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã.

### –ü–ª—é—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RPC –∏ Protocol Buffers? 

–ò—Ç–∞–∫, –ø–æ—á–µ–º—É –º—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è API? –†–∞–∑–≤–µ –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏—Ç—å JSON? –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏ —Ç–∞–∫, –Ω–æ —É Protobuf –µ—Å—Ç—å —Å–≤–æ–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.

#### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%94%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F)

–ü–µ—Ä–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Protocol Buffers –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ –¥–∞—é—Ç API —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –∏ —Å–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ö–µ–º—É. –ò—Å–ø–æ–ª—å–∑—É—è JSON, –º—ã –¥–æ–ª–∂–Ω—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ—Å—è –≤ –Ω–µ–º –ø–æ–ª—è –∏ –∏—Ö —Ç–∏–ø—ã. –ö–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π, –º—ã —Ä–∏—Å–∫—É–µ–º, —á—Ç–æ –æ–Ω–∞ –æ–∫–∞–∂–µ—Ç—Å—è –Ω–µ—Ç–æ—á–Ω–æ–π, –Ω–µ–ø–æ–ª–Ω–æ–π –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π. –ö–æ–≥–¥–∞ –∂–µ –º—ã –ø–∏—à–µ–º API –Ω–∞ Protobuf, –º—ã –º–æ–∂–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –Ω–µ–≥–æ –∫–æ–¥ Python. –¢–æ –µ—Å—Ç—å –∫–æ–¥ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äì —Ö–æ—Ä–æ—à–æ, –Ω–æ —Å–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥ ‚Äì –µ—â–µ –ª—É—á—à–µ.

#### –í–∞–ª–∏–¥–∞—Ü–∏—è[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%92%D0%B0%D0%BB%D0%B8%D0%B4%D0%B0%D1%86%D0%B8%D1%8F)

–í—Ç–æ—Ä–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ Python –∏–∑ –∫–æ–¥–∞ Protobuf –≤—ã –∑–∞–æ–¥–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä—É—é –±–∞–∑–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞

–ï—Å–ª–∏ –¥–ª—è API –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ HTTP –∏ JSON, –≤–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–∏—Å–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø—Ä–æ—Å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ, –æ–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç. –° –ø–æ–º–æ—â—å—é Protobuf –º–æ–∂–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ –∂–µ, –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º —Å–µ—Ç–µ–≤–æ–π –∑–∞–ø—Ä–æ—Å.

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C)

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ gRPC [–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞](https://docs.microsoft.com/ru-ru/aspnet/core/grpc/comparison?view=aspnetcore-5.0), —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ã—á–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤. gRPC –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ HTTP/2, –ø–æ–∑–≤–æ–ª—è—é—â–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ—Ç–æ—á–Ω–æ-–±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º. –°–æ–æ–±—â–µ–Ω–∏—è gRPC —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ –∏ –≤–µ—Å—è—Ç –º–µ–Ω—å—à–µ, —á–µ–º JSON. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, HTTP/2 –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —Å–∂–∞—Ç–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, –∞ gRPC ‚Äì –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤. –í –æ–±—â–µ–º, –ø–æ–ø—É—Ç–Ω–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –æ—Ç–ª–∏—á–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.

#### –£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%A3%D0%B4%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%BE-%D0%B4%D0%BB%D1%8F-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%87%D0%B8%D0%BA%D0%BE%D0%B2)

–í–µ—Ä–æ—è—Ç–Ω–æ, —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º–Ω–æ–≥–∏–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç gRPC, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–≤–æ–π API –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∞ –Ω–µ HTTP-–∫–æ–º–∞–Ω–¥ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤. –í REST API –º—ã –¥–æ–ª–∂–Ω—ã —Ä–µ—à–∏—Ç—å, –∫–∞–∫–∏–µ —É –Ω–∞—Å –µ—Å—Ç—å —Ä–µ—Å—É—Ä—Å—ã, –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—å –ø—É—Ç–∏, –∫–∞–∫ –Ω–∞–∑—ã–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã. –ß–∞—Å—Ç–æ —ç—Ç–∏ –∑–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ—à–µ–Ω—ã –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤, –≤ –∏—Ç–æ–≥–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ REST –Ω–µ—Ä–µ–¥–∫–æ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –¥–∏—Å–∫—É—Å—Å–∏—é –æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö. Protobuf —Å—Ä–æ–¥–Ω–∏ JSON –∏–ª–∏ XML –≤ —Ç–æ–º, —á—Ç–æ –≤—Å–µ –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è —Å–ø–æ—Å–æ–±–∞–º–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç JSON, Protocol Buffers –∏–º–µ—é—Ç —Å—Ç—Ä–æ–≥—É—é —Å—Ö–µ–º—É –∏ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ø–æ —Å–µ—Ç–∏.

## –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
### –û–ø—Ä–µ–¥–µ–ª–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤:
```
.
‚îú‚îÄ‚îÄ protobufs/
‚îÇ   ‚îî‚îÄ‚îÄ recommendations.proto 
|
‚îî‚îÄ‚îÄ recommendations/    
```

–ö–∞—Ç–∞–ª–æ–≥ `protobufs/` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º `recommendations.proto`. –°–æ–¥–µ—Ä–∂–∏–º—ã–º —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ –∫–æ–¥.

C–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–¥ Python –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–∏–º –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `recommendations/`. –í–æ-–ø–µ—Ä–≤—ã—Ö, –º—ã –¥–æ–ª–∂–Ω—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `grpcio-tools`. –°–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª `recommendations/requirements.txt` –∏ –¥–æ–±–∞–≤–∏–º —Å–ª–µ–¥—É—é—â–µ–µ:
```bash
grpcio-tools ~= 1.30
```

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ, –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω–æ–≤—É—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–º –≤ –Ω–µ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ü—Ä–∏–º–µ—Ä –¥–ª—è Windows:

```bash
C:\ python -m venv venv
C:\ venv\Scripts\activate.bat
(venv) C:\ python -m pip install -r requirements.txt    
```
–í Linux –∏ macOS –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
python3 -m venv venv
source venv/bin/activate  # Linux/macOS only
(venv) python -m pip install -r requirements.txt
```

### –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ Python –∏–∑ `protobufs`:
[[#–ü—Ä–∏–º–µ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã]] - file proto 
[v0 –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏](https://reddeveloper.ru/questions/kak-sgenerirovat-kod-python-grpc-iz-ustanovshchika-setuptools-setup-py-ovAdp)
```python
proto_files = ["proto/file1.proto", "proto/file2.proto"]

import subprocess
for file in proto_files:
    args = "--proto_path=. --python_out=. --grpc_python_out=. {0}".format(file)
    result = subprocess.call("python -m grpc_tools.protoc " + args, shell=True)
    print("grpc generation result for '{0}': code {1}".format(file, result))
```
v1 & v2 `–†—É—á–∫–∞–º–∏`
```bash
cd recommendations
python -m grpc_tools.protoc -I ../protobufs --python_out=. --grpc_python_out=./protobufs/recommendations.proto   

#`python -m grpc_tools.protoc` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ Python –∏–∑ –∫–æ–¥–∞ Protobuf,
#`-I ../protobufs` —Å–æ–æ–±—â–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, –≥–¥–µ –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–¥ Protobuf. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–º–ø–æ—Ä—Ç–∞, –Ω–æ —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ —Ñ–ª–∞–≥ `-I` –Ω–µ–æ–±—Ö–æ–¥–∏–º,
#`--python_out =. --grpc_python_out =.` —Å–æ–æ–±—â–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, –∫—É–¥–∞ –≤—ã–≤–æ–¥–∏—Ç—å —Ñ–∞–π–ª—ã Python,
#`../protobufs/recommendations.proto` ‚Äì —ç—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É protobuf, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ Python.
										#  v2
python3 -m grpc_tools.protoc --proto_path=/home/estathop/tf --python_out=/home/estathop/tf --grpc_python_out=/home/estathop/tweetf0rm ASD.proto
```
`python 3`, –æ–ø—Ä–µ–¥–µ–ª–∏–ª –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 
`proto_path` –¥–ª—è –ø–∞–ø–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª `.proto`
`python_out`, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–æ–≥–æ –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ç–∞ –∂–µ –ø–∞–ø–∫–∞, —á—Ç–æ –∏ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç `ASD_pb2.py`.
`grpc_python_out` —Ç–∞–∫–∂–µ –Ω—É–∂–µ–Ω –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è `ASD_pb2_grpc.py` 
`ASD.proto`, –∫–æ—Ç–æ—Ä—ã–π —è —Ö–æ—á—É –≤–∫–ª—é—á–∏—Ç—å –≤ `.proto` —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ç–µ–∫—É—â–µ–º –∞–∫—Ç–∏–≤–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ –æ–∫–Ω–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

```bash
ls
recommendations_pb2.py recommendations_pb2_grpc.py    
```
–≠—Ç–∏ —Ñ–∞–π–ª—ã –≤–∫–ª—é—á–∞—é—Ç —Ç–∏–ø—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ Python –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–∞—à–∏–º API. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä `—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥` –¥–ª—è –≤—ã–∑–æ–≤–∞ RPC –∏ `—Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ RPC`. –°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞.

### –ö–ª–∏–µ–Ω—Ç RPC
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ–Ω –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –ª—é–¥—å–º–∏. –ó–∞–ø—É—Å—Ç–∏–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –æ–±–æ–ª–æ—á–∫—É Python, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —ç—Ç–∏–º –∫–æ–¥–æ–º:

```python
from recommendations_pb2 import BookCategory, RecommendationRequest
request = RecommendationRequest(
	user_id=1, category=BookCategory.SCIENCE_FICTION, max_results=3
)
request.category
1    
```
–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä Protobuf —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–æ–≤ –≤ Python, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–∏–ø–∞–º –≤ –∫–æ–¥–µ Protobuf. –ü—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤:
```python
request = RecommendationRequest(
	user_id="oops", category=BookCategory.SCIENCE_FICTION, max_results=3
	)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'oops' has type str, but expected one of: int, long    
```

!!! __`–í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ`__: `–≤—Å–µ –ø–æ–ª—è –≤ `proto3` —è–≤–ª—è—é—Ç—Å—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏`. –ü–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã. –ï—Å–ª–∏ –≤—ã –Ω–µ —É–∫–∞–∂–µ—Ç–µ –∫–∞–∫–æ–µ-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω–æ –±—É–¥–µ—Ç __`—Ä–∞–≤–Ω–æ –Ω—É–ª—é`__ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –∏ __`–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–µ`__ –¥–ª—è —Å—Ç—Ä–æ–∫:

```py
request = RecommendationRequest(
user_id=1, category=BookCategory.SCIENCE_FICTION
	 )
request.max_results
0
```
–•–æ—Ç—è Protobuf –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–æ–≤, –Ω–∞–º –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ö–æ–≥–¥–∞ –º—ã —Ä–µ–∞–ª–∏–∑—É–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏, –º—ã –¥–æ–ª–∂–Ω—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ –¥–ª—è –ª—é–±–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–∏ –º—ã Protobuf, JSON –∏–ª–∏ —á—Ç–æ-—Ç–æ –µ—â–µ.

|—Ñ–∞–∏–ª|—Å–æ–¥–µ—Ä–∂–∏—Ç|
|---|---|
| `recommendations_pb2.py` |   –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤
| `recommendations_pb2_grpc.py` |  —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞:

```py
import grpc
from recommendations_pb2_grpc import RecommendationsStub
```
–ó–¥–µ—Å—å –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å `grpc`, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π `—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ —É–¥–∞–ª–µ–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º`. –ó–∞—Ç–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–≥–ª—É—à–∫—É (stub) –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞. –≠—Ç–æ –∑–∞–≥–ª—É—à–∫–∞, –ø–æ—Ç–æ–º—É –∫–∞–∫ —Å–∞–º –∫–ª–∏–µ–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π ‚Äì –æ–Ω –ª–∏—à—å –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–í–µ—Ä–Ω—É–≤—à–∏—Å—å –∫ –∫–æ–¥—É Protobuf, –≤ –∫–æ–Ω—Ü–µ –º—ã —É–≤–∏–¥–∏–º —Ä–∞–∑–¥–µ–ª `service Recommendations {...}`. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä Protobuf –±–µ—Ä–µ—Ç –∏–º—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ `Recommendations`, –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –Ω–µ–º—É `Stub`, —á—Ç–æ–±—ã —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞ `RecommendationsStub`.

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å __`RPC-–∑–∞–ø—Ä–æ—Å`__:

```python
channel = grpc.insecure_channel("localhost:50051")
client = RecommendationsStub(channel)
request = RecommendationRequest(
user_id=1, category=BookCategory.SCIENCE_FICTION, max_results=3
)
client.Recommend(request)
"""
Traceback (most recent call last):

grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
    status = StatusCode.UNAVAILABLE
    details = "failed to connect to all addresses"
    ...
   """ 
```
–ü—Ä–∏–º–µ—Ä —Å –∫–æ–Ω—Ç-–º –º–µ–Ω-—Ä–æ–º with(—Ö–∑ –ø—Ä–æ–≤–∏–ª—å–Ω–æ –ª–∏(–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å??))
```python
from alaska_pb2_grpc import AlaskerStub
from alaska_pb2 import Feature
import grpc

if __name__ == "__main__":
    with grpc.insecure_channel('0.0.0.0:4326') as channel:
        alasker_stub = AlaskerStub(channel)

        print(channel._connectivity_state.connectivity)

        rivers = alasker_stub.GetRivers(Feature())
        for river in rivers.rivers:
```
–ù–∞ –ø–æ—Ä—Ç—É 50051 –º—ã —Å–æ–∑–¥–∞–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å `localhost`, —Ç–æ –µ—Å—Ç—å –≤–∞—à–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–æ–π. –ü–æ—Ä—Ç 50051 —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø–æ—Ä—Ç–æ–º –¥–ª—è gRPC, –º–æ–∂–µ—Ç–µ –µ–≥–æ –∏–∑–º–µ–Ω–∏—Ç—å. –ó–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–µ–º –∫–∞–Ω–∞–ª `RecommendationsStub`, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∏–µ–Ω—Ç–∞.
–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ `Recommend`, –∫–æ—Ç–æ—Ä—ã–π –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–µ `Recommendations`. –û–¥–Ω–∞–∫–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø–æ–∫–∞ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ `localhost: 50051`. –ü–æ—Ä–∞ –ø—Ä–∏–Ω—è—Ç—å—Å—è –∑–∞ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å.

### –°–µ—Ä–≤–µ—Ä RPC

–ù–∞—á–Ω–µ–º —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏–º–ø–æ—Ä—Ç–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–±—Ä–∞–∑—Ü–æ–≤ –¥–∞–Ω–Ω—ã—Ö:
recommendations.py

```python
# recommendations/recommendations.py 	–°–µ—Ä–≤–µ—Ä RPC

from concurrent import futures
import random


import grpc

from recommendations_pb2 import (
    BookCategory,
    BookRecommendation,
    RecommendationResponse,
)

import recommendations_pb2_grpc

books_by_category = {
    BookCategory.MYSTERY: [
        BookRecommendation(id=1, title="The Maltese Falcon"),
        BookRecommendation(id=2, title="Murder on the Orient Express"),
        BookRecommendation(id=3, title="The Hound of the Baskervilles"),
    ],

    BookCategory.SCIENCE_FICTION: [
        BookRecommendation(
            id=4, title="The Hitchhiker's Guide to the Galaxy"
        ),
        BookRecommendation(id=5, title="Ender's Game"),
        BookRecommendation(id=6, title="The Dune Chronicles"),
    ],

    BookCategory.SELF_HELP: [
        BookRecommendation(
            id=7, title="The 7 Habits of Highly Effective People"
        ),

        BookRecommendation(
            id=8, title="How to Win Friends and Influence People"
        ),

        BookRecommendation(id=9, title="Man's Search for Meaning"),
    ],
}
    
```
—Å–æ–∑–¥–∞–¥–∏–º –∫–ª–∞—Å—Å in recommendations.py, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞:

```python
        class RecommendationService(
    recommendations_pb2_grpc.RecommendationsServicer
):

    def Recommend(self, request, context):
        if request.category not in books_by_category:
            context.abort(grpc.StatusCode.NOT_FOUND, "Category not found")

        books_for_category = books_by_category[request.category]
        num_results = min(request.max_results, len(books_for_category))
        books_to_recommend = random.sample(
            books_for_category, num_results
        )

        return RecommendationResponse(recommendations=books_to_recommend)
    
```
–ö–ª–∞—Å—Å `RecommendationService` ‚Äì —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—à–µ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–ª–∞—Å—Å –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –ø–æ–¥–∫–ª–∞—Å—Å–∞ `RecommendationServicer`. –≠—Ç–æ —á–∞—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å gRPC.

–î–∞–ª–µ–µ –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥ `Recommend`. –û–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ –∂–µ –∏–º—è, —á—Ç–æ –∏ RPC, –∫–æ—Ç–æ—Ä—ã–π –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤ —Å–≤–æ–µ–º —Ñ–∞–π–ª–µ `Protobuf`. –ú–µ—Ç–æ–¥ —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `Request` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `RecommendationResponse`, –∫–∞–∫ –∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ Protobuf. –ü–∞—Ä–∞–º–µ—Ç—Ä `context` –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è `response`.

–ú–µ—Ç–æ–¥ `abort()` –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è `NOT_FOUND`, –µ—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é. gRPC –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ–≤–µ—Ä—Ö HTTP/2, –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –∫–æ–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è HTTP.

–í —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ—á–∫–∞—Ö —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –∫–Ω–∏–≥–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ `max_results`.

–í –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `RecommendationResponse` —Å–æ —Å–ø–∏—Å–∫–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∫–Ω–∏–≥.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –±—ã–ª–æ –±—ã –ª–æ–≥–∏—á–Ω–æ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –≤—ã–∑—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `abort()`, –∫–∞–∫ –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ. –û–¥–Ω–∞–∫–æ —Ç–æ–≥–¥–∞ –æ—Ç–≤–µ—Ç –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

–ö–ª–∞—Å—Å `RecommendationService` —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞, –Ω–æ –Ω–∞–º –∫–∞–∫-—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∞–º —Å–µ—Ä–≤–∏—Å. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–º —Ñ—É–Ω–∫—Ü–∏—é `serve()` in recommendations.py:

```python
def serve():
    server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))
    recommendations_pb2_grpc.add_RecommendationsServicer_to_server(
        RecommendationService(), server
    )
    server.add_insecure_port("[::]:50051")
    server.start()
    server.wait_for_termination()

if __name__ == "__main__":
    serve()
    
```

`serve()` –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤. –í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –∫–æ–¥–µ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä gRPC, –∫–æ—Ç–æ—Ä–æ–º—É –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 10 –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –∏–∑–ª–∏—à–Ω–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞, –Ω–æ —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ Python. –î–∞–ª–µ–µ –º—ã —Å–≤—è–∑—ã–≤–∞–µ–º –∫–ª–∞—Å—Å —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ—Ç–æ–º –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä—É —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –ø–æ—Ä—Ç—É `50051`. –î–∞–ª–µ–µ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏ –∂–¥–µ–º, –ø–æ–∫–∞ –æ–Ω –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ ‚Äì –Ω–∞–∂–∞—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é `[Ctrl + C]`.

–ù–µ –∑–∞–∫—Ä—ã–≤–∞—è —Ç–µ—Ä–º–∏–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞, –æ—Ç–∫—Ä–æ–µ–º –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–ø–æ–ª–Ω–∏–º —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```bash
python recommendations.py
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Recommendations`, —Ç–∞–∫ —á—Ç–æ –º—ã —Å–º–æ–∂–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –¢–µ–ø–µ—Ä—å –≤–µ—Ä–Ω–µ–º—Å—è –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –∑–∞–≥–ª—É—à–∫—É –∫–∞–Ω–∞–ª–∞. –ï—Å–ª–∏ –≤—ã –æ—Å—Ç–∞–≤–∏–ª–∏ –∫–æ–Ω—Å–æ–ª—å –æ—Ç–∫—Ä—ã—Ç–æ–π, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–∞:

```python
import grpc
from recommendations_pb2_grpc import RecommendationsStub
channel = grpc.insecure_channel("localhost:50051")
client = RecommendationsStub(channel)
```

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –æ–±—ä–µ–∫—Ç, –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å:

```python
request = RecommendationRequest(
 user_id=1, category=BookCategory.SCIENCE_FICTION, max_results=3)
client.Recommend(request)
recommendations {
  id: 6
  title: "The Dune Chronicles"
}
recommendations {
  id: 4
  title: "The Hitchhiker\'s Guide To The Galaxy"
}
recommendations {
  id: 5
  title: "Ender\'s Game"
}    
```

–†–∞–±–æ—Ç–∞–µ—Ç! –ú—ã —Å–¥–µ–ª–∞–ª–∏ RPC-–∑–∞–ø—Ä–æ—Å –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—É –∏ –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä, –º—ã –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Marketplace` –∏ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤—ã–∑—ã–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å Python, –Ω–æ –æ—Å—Ç–∞–≤—å—Ç–µ –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Recommendations`.

### –°–≤—è–∑—ã–≤–∞–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –≤–º–µ—Å—Ç–µ

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ `marketplace/` –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –Ω–µ–≥–æ —Ñ–∞–π–ª `marketplace.py` –¥–ª—è —Å–≤–æ–µ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ `Marketplace`. –î–µ—Ä–µ–≤–æ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –¥–æ–ª–∂–Ω–æ —Ç–µ–ø–µ—Ä—å –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

```
        .
‚îú‚îÄ‚îÄ marketplace/
‚îÇ   ‚îú‚îÄ‚îÄ marketplace.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îî‚îÄ‚îÄ homepage.html
|
‚îú‚îÄ‚îÄ protobufs/
‚îÇ   ‚îî‚îÄ‚îÄ recommendations.proto
|
‚îî‚îÄ‚îÄ recommendations/
    ‚îú‚îÄ‚îÄ recommendations.py
    ‚îú‚îÄ‚îÄ recommendations_pb2.py
    ‚îú‚îÄ‚îÄ recommendations_pb2_grpc.py
    ‚îî‚îÄ‚îÄ requirements.txt
    
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ `marketplace/` –¥–ª—è –∫–æ–¥–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞, `requirements.txt` –∏ `homepage.html` –¥–ª—è –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í—Å—ë —ç—Ç–æ –±—É–¥–µ—Ç –æ–ø–∏—Å–∞–Ω–æ –Ω–∏–∂–µ. –ü–æ–∫–∞ –¥–ª—è –Ω–∏—Ö –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã.

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Marketplace` –±—É–¥–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º Flask –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã. –û–Ω –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Recommendations`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–Ω–∏–≥–∞–º. –û—Ç–∫—Ä–æ–µ–º —Ñ–∞–π–ª `marketplace/marketplace.py` –∏ –¥–æ–±–∞–≤–∏–º —Å–ª–µ–¥—É—é—â–µ–µ:

marketplace.py

```python
# marketplace/marketplace.py

import os

from flask import Flask, render_template
import grpc


from recommendations_pb2 import BookCategory, RecommendationRequest
from recommendations_pb2_grpc import RecommendationsStub


app = Flask(__name__)

recommendations_host = os.getenv("RECOMMENDATIONS_HOST", "localhost")
# –µ—Å–ª–∏ –º—ã —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º, Python –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –∏—Ö —Å –ø–æ–º–æ—â—å—é —Å–±–æ—Ä—â–∏–∫–∞ –º—É—Å–æ—Ä–∞, –∏ –º—ã –ø–æ—Ç–µ—Ä—è–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤
recommendations_channel = grpc.insecure_channel(
    f"{recommendations_host}:50051"
)
recommendations_client = RecommendationsStub(recommendations_channel)


@app.route("/")
def render_homepage():
    recommendations_request = RecommendationRequest(
        user_id=1, category=BookCategory.MYSTERY, max_results=3
    )
    recommendations_response = recommendations_client.Recommend(
        recommendations_request
    )
    return render_template(
        "homepage.html",
        recommendations=recommendations_response.recommendations,
    )
    
```

–ó–¥–µ—Å—å –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Flask, —Å–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç gRPC –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã —Å–æ–∑–¥–∞–µ–º –∫–∞–Ω–∞–ª –∏ –∑–∞–≥–ª—É—à–∫—É gRPC –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã. –û–±—ã—á–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–µ—â–µ–Ω—ã, –Ω–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.–ö–∞–Ω–∞–ª gRPC –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º. –û–Ω –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–∞–∑–æ—Ä–≤–∞–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –º—ã —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º, Python –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –∏—Ö —Å –ø–æ–º–æ—â—å—é —Å–±–æ—Ä—â–∏–∫–∞ –º—É—Å–æ—Ä–∞, –∏ –º—ã –ø–æ—Ç–µ—Ä—è–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤.–ú—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –∫–∞–Ω–∞–ª –æ—Å—Ç–∞–≤–∞–ª—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º –∏ –Ω–∞–º –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ú—ã –º–æ–∂–µ–º —Å–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª –≤–Ω—É—Ç—Ä–∏ –¥—Ä—É–≥–æ–≥–æ –º–æ–¥—É–ª—è, –Ω–æ –ø–æ—Å–∫–æ–ª—å–∫—É –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —É –Ω–∞—Å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª, –º—ã –º–æ–∂–µ–º —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É, –∏—Å–ø–æ–ª—å–∑—É—è –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

–û—Ç–∫—Ä–æ–µ–º —Ñ–∞–π–ª `homepage.html` –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `marketplace/templates/` –∏ –¥–æ–±–∞–≤–∏–º —Å–ª–µ–¥—É—é—â–∏–π HTML-–∫–æ–¥:

homepage.html

```html
<!-- homepage.html -->
<!doctype html>
<html lang="en">
<head>
    <title>Online Books For You</title>
</head>
<body>
    <h1>Mystery books you may like</h1>
    <ul>
    {% for book in recommendations %}
        <li>{{ book.title }}</li>
    {% endfor %}
    </ul>
</body>
    
```

–≠—Ç–æ –¥–µ–º–æ –Ω–∞—à–µ–π –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ö–æ–≥–¥–∞ –º—ã –∑–∞–∫–æ–Ω—á–∏–º, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö –∫–Ω–∏–≥.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–¥–∞ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –≤ `marketplace/requirements.txt`:

```
flask ~= 1.1
grpcio-tools ~= 1.30
Jinja2 ~= 2.11
pytest ~= 5.4
```

–ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –±—É–¥—É—Ç –∏–º–µ—Ç—å —Å–≤–æ–π —Ñ–∞–π–ª `requirements.txt`, –Ω–æ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É –¥–ª—è –æ–±–æ–∏—Ö. –í—ã–ø–æ–ª–Ω–∏–º —Å–ª–µ–¥—É—é—â–µ–µ, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É:

```bash
python -m pip install -r marketplace/requirements.txt
```

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –Ω—É–∂–Ω–æ —Ç–∞–∫–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è `protobufs` –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `marketplace/`. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–ª–µ–¥—É—é—â–µ–µ:

```bash
cd marketplace
python -m grpc_tools.protoc -I ../protobufs --python_out=.  --grpc_python_out=. ../protobufs/recommendations.proto
```

–≠—Ç–æ —Ç–∞ –∂–µ –∫–æ–º–∞–Ω–¥–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –∑–∞–ø—É—Å–∫–∞–ª–∏ —Ä–∞–Ω—å—à–µ, —Ç–∞–∫ —á—Ç–æ –∑–¥–µ—Å—å –Ω–µ—Ç –Ω–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ. –ú–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–Ω—ã–º –∏–º–µ—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Ñ–∞–π–ª—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–∞—Ö `Marketplace/` –∏ `Recommendations`, –Ω–æ –ø–æ–∑–∂–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ, –∫–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏—Ö –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è. –¢–æ –µ—Å—Ç—å –æ–±—ã—á–Ω–æ –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –≤ —Å–∏—Å—Ç–µ–º–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π.

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Marketplace`, –≤–≤–µ–¥–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å —Å–ª–µ–¥—É—é—â–µ–µ:

```bash
FLASK_APP=marketplace.py flask run
```

–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã `Recommendations` –∏ `Marketplace`, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –≤ –¥–≤—É—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö. –ï—Å–ª–∏ –≤—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Ä–∞–±–æ—Ç—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ `Recommendations`, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ:

```bash
cd recommendations
python recommendations.py
```

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –Ω–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –∑–∞–ø—É—â–µ–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Flask, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 5000. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

![üê≥ –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Python –∏ gRPC](https://media.proglib.io/posts/2021/02/12/51b8e3249146e6439ab87e1a16318784.png)

–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—â–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º. –ù–æ –æ–Ω–∏ –≤—Å–µ –µ—â–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –Ω–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ. –î–∞–ª–µ–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –≤–Ω–µ–¥—Ä–∏—Ç—å –∏—Ö –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É.

–ú–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã Python, –Ω–∞–∂–∞–≤ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ `Ctrl + C`. –î–∞–ª–µ–µ –º—ã –±—É–¥–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –≤ Docker.

## üê≥ –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã Python –≤ Docker

[Docker](https://proglib.io/p/docker) ‚Äì —ç—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞ –æ–¥–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Ç –¥—Ä—É–≥–∏—Ö. Docker –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ Python, –ø–æ—Å–∫–æ–ª—å–∫—É –≤—ã –º–æ–∂–µ—Ç–µ —É–ø–∞–∫–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker (–µ–≥–æ –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://docs.docker.com/get-docker/)).

–ú—ã —Å–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ –æ–±—Ä–∞–∑–∞ Docker: –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤. –û–±—Ä–∞–∑ ‚Äì —ç—Ç–æ –ø–æ —Å—É—Ç–∏ —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–ª—é—Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–ø—É—â–µ–Ω Docker, –∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Ä—Ç—ã –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

–û–±—Ä–∞–∑—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–ø–∏—Å–∞–Ω–∏—è –≤ –≤–∏–¥–µ `Dockerfile`. –í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –≤—Å–µ–≥–¥–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä Python. –î–∞–ª–µ–µ –º—ã —Å–∫–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –∏–∑ —Å–≤–æ–µ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ –æ–±—Ä–∞–∑ Docker –∏ –∑–∞–ø—É—Å—Ç–∏–º –∫–æ–º–∞–Ω–¥—É –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

### Dockerfile –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ Recommendations

–ù–∞—á–Ω–µ–º —Å —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–∞ Docker –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –°–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª `Recommendations/Dockerfile` –∏ –¥–æ–±–∞–≤–∏–º –≤ –Ω–µ–≥–æ —Å–ª–µ–¥—É—é—â–µ–µ:

Recommendations/Dockerfile

```Dockerfile
FROM python

RUN mkdir /service
COPY protobufs/ /service/protobufs/
COPY recommendations/ /service/recommendations/
WORKDIR /service/recommendations
RUN python -m pip install --upgrade pip
RUN python -m pip install -r requirements.txt
RUN python -m grpc_tools.protoc -I ../protobufs --python_out=. \
           --grpc_python_out=. ../protobufs/recommendations.proto

EXPOSE 50051
ENTRYPOINT [ "python", "recommendations.py" ]
    
```

–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ—á–∫–µ –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–∑ —Å –ø–æ–º–æ—â—å—é –±–∞–∑–æ–≤–æ–π —Å—Ä–µ–¥—ã Linux –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ Python. –û–±—Ä–∞–∑ –Ω–∞ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∏–º–µ–µ—Ç —Ç–∏–ø–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã Linux. –î–∞–ª–µ–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –≤ `/service` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞. –ü–æ—Ç–æ–º –º—ã –∫–æ–ø–∏—Ä—É–µ–º –∫–∞—Ç–∞–ª–æ–≥–∏ `protobufs/` –∏ `recommendations` –≤ `/service`.

–ó–∞—Ç–µ–º –º—ã —Å–æ–∑–¥–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥ `/service/recommendations` –∏ –¥–µ–ª–∞–µ–º –µ–≥–æ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫ Python –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º Python-—Ñ–∞–π–ª—ã –∏–∑ –∫–æ–¥–∞ Protobuf.

–í –∏—Ç–æ–≥–µ –ø–∞–ø–∫–∞ `/service/` –≤–Ω—É—Ç—Ä–∏ Docker-–æ–±—Ä–∞–∑–∞ –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```
        /service/
|
‚îú‚îÄ‚îÄ protobufs/
‚îÇ   ‚îî‚îÄ‚îÄ recommendations.proto
|
‚îî‚îÄ‚îÄ recommendations/
    ‚îú‚îÄ‚îÄ recommendations.py
    ‚îú‚îÄ‚îÄ recommendations_pb2.py
    ‚îú‚îÄ‚îÄ recommendations_pb2_grpc.py
    ‚îî‚îÄ‚îÄ requirements.txt    
```

–ù–∞–∫–æ–Ω–µ—Ü, –º—ã –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞—Ä—É–∂—É Docker-–æ–±—Ä–∞–∑–∞ –Ω–∞ –ø–æ—Ä—Ç–µ `50051` –∏ –≥–æ–≤–æ—Ä–∏–º Docker –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞—à –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –≤ Python, –ø–µ—Ä–µ–¥–∞–≤ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞.

–ú—ã –æ–ø–∏—Å–∞–ª–∏ –≤—Å—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –≤ Dockerfile. –ß—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Docker-–æ–±—Ä–∞–∑, –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ Dockerfile –∏ –∑–∞–ø—É—Å—Ç–∏–º –∫–æ–º–∞–Ω–¥—É `build`:

```bash
docker build . -f recommendations/Dockerfile -t recommendations    
# –ö–æ–≥–¥–∞ Docker —Å–æ–∑–¥–∞—Å—Ç –æ–±—Ä–∞–∑, –º—ã —Å–º–æ–∂–µ–º –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
docker run -p 127.0.0.1:50051:50051/tcp recommendations 
```

–í—ã –Ω–µ —É–≤–∏–¥–∏—Ç–µ –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ. –ö–æ–≥–¥–∞ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–∑, –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –ú—ã –º–æ–∂–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

–ü–∞—Ä–∞–º–µ—Ç—Ä `-p 127.0.0.1:50051:50051/tcp` —É–∫–∞–∑—ã–≤–∞–µ—Ç Docker –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ø–æ—Ä—Ç–∞ 50051 –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –Ω–∞ –ø–æ—Ä—Ç `50051` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

### Dockerfile –¥–ª—è Marketplace
–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –æ–±—Ä–∞–∑ `Marketplace`. –ù–∞–ø–∏—à–µ–º –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Ñ–∞–π–ª `Marketplace/Dockerfile`:
Marketplace/Dockerfile

```Dockerfile
FROM python

RUN mkdir /service
COPY protobufs/ /service/protobufs/
COPY marketplace/ /service/marketplace/
WORKDIR /service/marketplace
RUN python -m pip install --upgrade pip
RUN python -m pip install -r requirements.txt
RUN python -m grpc_tools.protoc -I ../protobufs --python_out=. \
           --grpc_python_out=. ../protobufs/recommendations.proto

EXPOSE 5000
ENV FLASK_APP=marketplace.py
ENTRYPOINT [ "flask", "run", "--host=0.0.0.0"]    
```
–≠—Ç–æ—Ç Dockerfile –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂ –Ω–∞ —Ç–æ—Ç, —á—Ç–æ –º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ Recommendations, –ª–∏—à—å —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –æ—Ç–ª–∏—á–∏—è–º–∏ –≤ –∫–æ–Ω—Ü–µ: `ENV FLASK_APP=marketplace.py` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `FLASK_APP` –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–∑–∞, —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã Flask. –ü–∞—Ä–∞–º–µ—Ç—Ä `--host=0.0.0.0` –ø–æ–∑–≤–æ–ª—è–µ—Ç Flask –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç localhost –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–∑–∞.

–°–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
```bash
docker build . -f marketplace/Dockerfile -t marketplace
docker run -p 127.0.0.1:5000:5000/tcp marketplace
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏[](http://localhost:8888/doc/tree/microservices/gRPC.ipynb#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D1%81%D0%B5%D1%82%D0%B8)

–•–æ—Ç—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã `Recommendations` –∏ `Marketplace` —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –µ—Å–ª–∏ –º—ã —Å–µ–π—á–∞—Å –ø–µ—Ä–µ–π–¥–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:5000`, –º—ã –ø–æ–ª—É—á–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã.

–ö —Å—á–∞—Å—Ç—å—é, Docker –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã. –ú—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å–µ—Ç—å –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–µ–µ –æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∞ —Ç–∞–∫–∂–µ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∏–º DNS-–∏–º–µ–Ω–∞, —á—Ç–æ–±—ã –æ–Ω–∏ –º–æ–≥–ª–∏ –Ω–∞–π—Ç–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

–ù–∏–∂–µ –º—ã —Å–æ–∑–¥–∞–µ–º —Å–µ—Ç—å –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º `microservices` –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –≤ –Ω–µ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –°–Ω–∞—á–∞–ª–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –ø–æ–º–æ—â—å—é `Ctrl + C`. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ:

```
        docker network create microservices
docker run -p 127.0.0.1:50051:50051/tcp --network microservices \
             --name recommendations recommendations
    
```

–ö–æ–º–∞–Ω–¥–∞ `docker network create` —Å–æ–∑–¥–∞–µ—Ç —Å–µ—Ç—å. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ ‚Äì –¥–∞–ª–µ–µ –∫ —ç—Ç–æ–π —Å–µ—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –î–∞–ª–µ–µ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –∫–æ–º–∞–Ω–¥—É docker run, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ —ç—Ç–æ–π —Å–µ—Ç–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä `‚Äë‚Äëname recommendations` —É–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ —Å–µ—Ç–∏.

–ü–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `Marketplace` –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥. –°–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ—á–∫—É –≤ `marketplace.py`

marketplace.py

```
        recommendations_channel = grpc.insecure_channel("localhost:50051")
    
```

–Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É `recommendations:50051`. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–∞–±–æ—Ç—ã –º—ã —É–∫–∞–∂–µ–º –∏–º—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã. –ó–∞–º–µ–Ω–∏–º —Å—Ç—Ä–æ–∫—É –≤—ã—à–µ –¥–≤—É–º—è —Å–ª–µ–¥—É—é—â–∏–º–∏:

marketplace.py

```
        recommendations_host = os.getenv("RECOMMENDATIONS_HOST", "localhost")
recommendations_channel = grpc.insecure_channel(
    f"{recommendations_host}:50051"
)

    
```

–≠—Ç–∏ —Å—Ç—Ä–æ—á–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–º—è —Ö–æ—Å—Ç–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—ã `RECOMMENDATIONS_HOST`. –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ä–µ–¥—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ `localhost`. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–¥ –∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, –∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

–ú—ã –∏–∑–º–µ–Ω–∏–ª–∏ –∫–æ–¥, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ `marketplace`. –ó–∞–ø—É—Å—Ç–∏–º –µ–≥–æ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏:

```
        docker build . -f marketplace/Dockerfile -t marketplace
docker run -p 127.0.0.1:5000:5000/tcp --network microservices \
             -e RECOMMENDATIONS_HOST=recommendations marketplace
    
```

–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤—ã –º–æ–∂–µ—Ç–µ —Å–Ω–æ–≤–∞ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—å `localhost:5000` –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –∏ —Ç–µ–ø–µ—Ä—å —É–∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è.

### Docker Compose

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, —Ç–∞–∫–∞—è —Ä–∞–±–æ—Ç–∞ —Å Docker –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ–º–Ω–æ–≥–æ —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ. –ë—ã–ª–æ –±—ã –Ω–µ–ø–ª–æ—Ö–æ –∏–º–µ—Ç—å –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä–∞—è –±—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∞ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `docker-compose` –∏ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –ø—Ä–æ–µ–∫—Ç–∞ Docker.

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∑–∞–ø—É—Å–∫–∞—Ç—å –∫—É—á—É –∫–æ–º–∞–Ω–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤, —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ç–µ–π –∏ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –º—ã –º–æ–∂–µ–º –æ–±—ä—è–≤–∏—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º YAML-—Ñ–∞–π–ª–µ `docker-compose.yaml`, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –æ—Ç–¥–µ–ª—å–Ω—ã–º –¥–æ–∫–µ—Ä—Ñ–∞–π–ª–∞–º –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—é—É—â–∏—Ö –ø–∞–ø–∫–∞—Ö:

docker-compose.yaml

```
        version: "3.8"
services:

    marketplace:
        build:
            context: .
            dockerfile: marketplace/Dockerfile
        environment:
            RECOMMENDATIONS_HOST: recommendations
        image: marketplace
        networks:
            - microservices
        ports:
            - 5000:5000
    recommendations:
        build:
            context: .
            dockerfile: recommendations/Dockerfile
        image: recommendations
        networks:
            - microservices


networks:
    microservices:
    
```

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞, –∞ —Å–∞–º –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```
        .
‚îú‚îÄ‚îÄ marketplace/
‚îÇ   ‚îú‚îÄ‚îÄ marketplace.py
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îî‚îÄ‚îÄ homepage.html
|
‚îú‚îÄ‚îÄ protobufs/
‚îÇ   ‚îî‚îÄ‚îÄ recommendations.proto
|
‚îú‚îÄ‚îÄ recommendations/
‚îÇ   ‚îú‚îÄ‚îÄ recommendations.py
‚îÇ   ‚îú‚îÄ‚îÄ recommendations_pb2.py
‚îÇ   ‚îú‚îÄ‚îÄ recommendations_pb2_grpc.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ
‚îî‚îÄ‚îÄ docker-compose.yaml
    
```

–í —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –º—ã –Ω–µ –±—É–¥–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ –≤–¥–∞–≤–∞—Ç—å—Å—è –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –º—ã —É–∂–µ –¥–µ–ª–∞–ª–∏ –≤—Ä—É—á–Ω—É—é. –ù–æ —Ç–µ–ø–µ—Ä—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–±—Ä–∞—Ç—å –ª–∏—à—å –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É:

```
        docker-compose up
    
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –º–æ–¥—É–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ Python –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ –∏ –≤—ã–∑–≤–∞—Ç—å –µ–≥–æ –º–µ—Ç–æ–¥—ã. –í–æ—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –¥–ª—è `RecommendationService`:

recommendations/recommendations\_test.py

```
        # recommendations/recommendations_test.py

from recommendations import RecommendationService
from recommendations_pb2 import BookCategory, RecommendationRequest

def test_recommendations():
    service = RecommendationService()
    request = RecommendationRequest(
        user_id=1, category=BookCategory.MYSTERY, max_results=1
    )
    response = service.Recommend(request, None)
    assert len(response.recommendations) == 1
    
```

[–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D0%B3%D1%80%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%BE%D0%B5_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5#:~:text=Integration%20and%20Testing%2C%20%D0%B0%D0%B1%D0%B1%D1%80%D0%B5%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0%20%D0%B0%D0%BD%D0%B3%D0%BB,%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D0%B8%20%D0%BF%D1%80%D0%B5%D0%B4%D1%88%D0%B5%D1%81%D1%82%D0%B2%D1%83%D0%B5%D1%82%20%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%BD%D0%BE%D0%BC%D1%83%20%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8E.) –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –Ω–µ–∏–º–∏—Ç–∏—Ä—É–µ–º—ã—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤. –¢–∞–∫ —á—Ç–æ —ç—Ç–æ –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ. –î–æ–±–∞–≤–∏–º —Ñ–∞–π–ª `marketplace/marketplace_integration_test.py`

```
        from urllib.request import urlopen

def test_render_homepage():
    homepage_html = urlopen("http://localhost:5000").read().decode("utf-8")
    assert "<title>Online Books For You</title>" in homepage_html
    assert homepage_html.count("<li>") == 3
    
```

–î–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å –∫ URL-–∞–¥—Ä–µ—Å—É –¥–æ–º–∞—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–π HTML-–∫–æ–¥ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —Ç—Ä–µ–º—è –º–∞—Ä–∫–µ—Ä–∞–º–∏ `<li>`. –≠—Ç–æ –Ω–µ —Å–∞–º—ã–π –ø–æ–ª–µ–∑–Ω—ã–π —Ç–µ—Å—Ç, –Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏–¥–µ–∏. –¢–µ—Å—Ç –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —Ç–æ–ª—å–∫–æ, –µ—Å–ª–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Recommendations` –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç. –î–∞–∂–µ –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `Marketplace`, –æ—Ç–ø—Ä–∞–≤–∏–≤ –µ–º—É HTTP-–∑–∞–ø—Ä–æ—Å.

–ó–∞–ø—É—Å—Ç–∏–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã Python —Å –ø–æ–º–æ—â—å—é docker-compose, –º—ã –º–æ–∂–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –Ω–∏—Ö –∫–æ–º–∞–Ω–¥—ã —Å –ø–æ–º–æ—â—å—é `docker-compose exec`. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `Marketplace`, –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –Ω–∞–±–æ—Ä –∫–æ–º–∞–Ω–¥:

```
        docker-compose build
docker-compose up
docker-compose exec marketplace pytest marketplace_integration_test.py
    
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–º–∞–Ω–¥—É `pytest` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `marketplace`. –ü–æ—Å–∫–æ–ª—å–∫—É –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ `localhost`, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –≤ —Ç–æ–º –∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, —á—Ç–æ –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å.

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Kubernetes

–¢–µ–ø–µ—Ä—å –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤. –í—ã –º–æ–∂–µ—Ç–µ –±—ã—Å—Ç—Ä–æ –≤—ã–∑–≤–∞—Ç—å –∏—Ö –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã. –ú—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞. –ù–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–≤–∏–Ω—É—Ç—å—Å—è –¥–∞–ª—å—à–µ –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ Kubernetes, –º—ã –æ—Ç—Å—ã–ª–∞–µ–º –≤–∞—Å –∫ [–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –î—ç–Ω–∞ –•–∏–ø—à–º–∞–Ω–∞](https://realpython.com/python-microservices-grpc/#production-ready-python-microservices). –¢–∞–º –∂–µ –≤—ã –º–æ–∂–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö —Ä–∞–±–æ—Ç—ã —Å gRPC.

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ —Ç–µ–º–µ:**

-   [gRPC –∏ –≤—Å–µ-–≤—Å–µ-–≤—Å–µ: –ß–∞—Å—Ç—å I. –í–≤–µ–¥–µ–Ω–∏–µ](https://proglib.io/p/grpc-i-vse-vse-vse-chast-i-vvedenie-2021-03-26).


_____________
## Links
[[protobuf]] | [[Docker]] | [[Flask]]
[–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Python –∏ gRPC](https://proglib.io/p/mikroservisnaya-arhitektura-na-primere-python-i-grpc-2021-02-12)
https://proglib.io/p/grpc-i-vse-vse-vse-chast-i-vvedenie-2021-03-26
[GIT](https://github.com/grpc/grpc/releases)